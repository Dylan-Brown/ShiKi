<html>
<p><h1>SHIKI <img src="images/logo.png" align="right" width="200" height="auto" onclick="onLogo();" id="logo"> </h1> </p>

<h2><center>Search Page
<br><br>Please choose your weather tags
<br><br>
<br>
</center></h2>

<body background="images/Background.jpg" >
<form action="">
	<input type="checkbox" id="tag01" name="weather tags" value="Summer">Summer <br>
	<input type="checkbox" id="tag02" name="weather tags" value="Winter">Winter <br> 
	<input type="checkbox" id="tag03" name="weather tags" value="Fall">Fall <br> 
	<input type="checkbox" id="tag04" name="weather tags" value="Spring">Spring <br>
	<input type="checkbox" id="tag05" name="weather tags" value="below 10º">below 10&#176; <br>
	<input type="checkbox" id="tag06" name="weather tags" value="10º - 30º">10&#176; - 30&#176; <br>
	<input type="checkbox" id="tag07" name="weather tags" value="30º - 50º">30&#176;- 50&#176; <br>
	<input type="checkbox" id="tag08" name="weather tags" value="50º - 70º">50&#176; - 70&#176; <br>
	<input type="checkbox" id="tag09" name="weather tags" value="70º - 90º">70&#176; - 90&#176; <br>
	<input type="checkbox" id="tag10" name="weather tags" value="above 90º">above 90&#176; <br> 
	<input type="checkbox" id="tag11" name="weather tags" value="Casual">Casual <br>
	<input type="checkbox" id="tag12" name="weather tags" value="Business">Business <br>
	<input type="checkbox" id="tag13" name="weather tags" value="Party">Party 
	</form>
	
	<center><input type="submit" id="submit" onclick="submit()" value="Search"></center>
	
	<script>
		var summer = 0;
		var winter = 0;
		var fall = 0;
		var spring = 0;
		var belowten = 0;
		var tentothirty = 0;
		var thirtytofifty = 0;
		var fiftytoseventy = 0;
		var seventytoninety = 0;
		var aboveninety = 0;
		var casual = 0;
		var business = 0;
		var party = 0;
		

		window.onload = load();
		

		function load() {
			//alert("ha");
			//alert("change");
		}
		function submit() {
			console.log("submit button clicked");
			if (valid() == 0) {
				alert("Error: Please select at least one tag");
				return;
			}	
			
			var mesg = "";
			mesg = mesg + summer + winter + fall + spring + belowten
					+ tentothirty + thirtytofifty + fiftytoseventy
					+ seventytoninety + aboveninety + casual + business + party;
			console.log(mesg);
			
			sendMsg(mesg);
			//location.href = 'https://fling.seas.upenn.edu/~judyweng/cgi-bin/shiki-search.php?q=' + mesg;
			
		}

		//find the tags that are checked
		function checkedTag() {
			var checked = "";

			if(summer > 0) {
				checked += "summer,";
			}
			if(winter > 0) {
				checked += "winter,";
			}
			if(fall > 0) {
				checked += "fall,";
			}
			if(spring > 0) {
				checked += "spring,";
			}
			if(belowten > 0) {
				checked += "belowten,";
			}
			if(tentothirty > 0) {
				checked += "tentothirty,";
			}
			if(thirtytofifty > 0) {
				checked += "thirtytofifty,";
			}
			if(fiftytoseventy > 0) {
				checked += "fiftytoseventy,";
			}
			if(seventytoninety > 0) {
				checked += "seventytoninety,";
			}
			if(aboveninety > 0) {
				checked += "aboveninety,";
			}
			if(casual > 0) {
				checked += "casual,";
			}
			if(business > 0) {
				checked += "business,";
			}
			if(party > 0) {
				checked += "party,";
			}
			//alert("checked\n\n"+checked);
			return checked;
		}
		
		function sendMsg(msg) {
			console.log(msg);
			var xmlhttp = new XMLHttpRequest();
			xmlhttp.onreadystatechange = function() {
				if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
					console.log("readyState = 4, status = 200, " + msg);
					///alert("sanity check");
					window.location="shiki-search-results.html?tags=" + checkedTag()+ "&q=" + xmlhttp.responseText;
				}
			};

			xmlhttp.open("GET", "https://fling.seas.upenn.edu/~judyweng/cgi-bin/shiki-search.php?q=" + msg, true);
			xmlhttp.send();
		}
		

		function valid() {
			if (summer + winter + fall + spring + belowten + tentothirty + thirtytofifty + fiftytoseventy
					+ seventytoninety + aboveninety + casual + business + party < 1)
				return 0;
			else
				return 1;
		}
		function onLogo() {
			window.location="shiki-home.html";
		} 

		// add listeners for each button
		document.getElementById("tag01").addEventListener("click", function() {
			summer = 1 - summer;
		}, false);
		document.getElementById("tag02").addEventListener("click", function() {
			winter = 1 - winter;
		}, false);
		document.getElementById("tag03").addEventListener("click", function() {
			fall = 1 - fall;
		}, false);
		document.getElementById("tag04").addEventListener("click", function() {
			spring = 1 - spring;
		}, false);
		document.getElementById("tag05").addEventListener("click", function() {
			belowten = 1 - belowten;
		}, false);
		document.getElementById("tag06").addEventListener("click", function() {
			tentothirty = 1 - tentothirty;
		}, false);
		document.getElementById("tag07").addEventListener("click", function() {
			thirtytofifty = 1 - thirtytofifty;
		}, false);
		document.getElementById("tag08").addEventListener("click", function() {
			fiftytoseventy = 1 - fiftytoseventy;
		}, false);
		document.getElementById("tag09").addEventListener("click", function() {
			seventytoninety = 1 - seventytoninety;
		}, false);
		document.getElementById("tag10").addEventListener("click", function() {
			aboveninety = 1 - aboveninety;
		}, false);
		document.getElementById("tag11").addEventListener("click", function() {
			casual = 1 - casual;
		}, false);
		document.getElementById("tag12").addEventListener("click", function() {
			business = 1 - business;
		}, false);
		document.getElementById("tag13").addEventListener("click", function() {
			party = 1 - party;
		}, false);
	</script>

</body>